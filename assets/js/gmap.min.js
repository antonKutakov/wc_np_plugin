var map,script=document.createElement("script");script.src="//maps.googleapis.com/maps/api/js?sensor=false&callback=initMap",document.body.appendChild(script);var warehouse,warehouse_count,markers=[];function initMap(){map=new google.maps.Map(document.getElementById("map_canvas"),{zoom:14,center:{lat:48.3794,lng:31.1656},mapTypeId:"roadmap"}),jQuery(function(e){e(".wusd_city").on("change",function(a){var t=e(".wusd_city option:selected").text();e.ajax({type:"GET",data:"city="+t+"&action=wusd_get_warehouses",async:!1,url:ajaxurl.url,success:function(e){response=JSON.parse(e),clearMarkers(),moveToMarker(),placeMarker()}})})})}function placeMarker(){var e=response,a=document.getElementById("total_int").textContent;let t;t=parseFloat(a)<=30||response.length<3?e.filter(e=>e.PlaceMaxWeightAllowed):e.filter(e=>e.PlaceMaxWeightAllowed>30);for(var n=0;n<t.length;n++){var o=t;if(latitude=t[n].Latitude,longitude=t[n].Longitude,latitude>0&&longitude>0)var r={lat:Number(latitude),lng:Number(longitude)};var s=new google.maps.Marker({position:r,icon:"https://novaposhta.ua/uploads/misc/img/google/cargo.png",map:map});markers.push(s);var i=new google.maps.InfoWindow({maxWidth:150});google.maps.event.addListener(s,"click",function(e,a){return function(){i.setContent('<h5 id="warehouse_num">'+o[a].Description+'</h5><div id="warehouse_time"><span class="wusd_open">'+o[a].Phone+'</span><span class="wusd_close"></span></div><div id="warehouse_weight"></div></div>'),i.open(map,e)}}(s,n))}}function moveToMarker(){warehouse_count=Object.keys(response).length;for(var e=0;e<warehouse_count;e++)latitude=48.3794,longitude=31.1656,latitude>0&&longitude>0&&(latitude=response[e].Latitude,longitude=response[e].Longitude),map.panTo(new google.maps.LatLng(Number(latitude),Number(longitude)))}function setMapOnAll(e){for(var a=0;a<markers.length;a++)markers[a].setMap(e)}function clearMarkers(){setMapOnAll(null)}function showMarkers(){setMapOnAll(map)}function deleteMarkers(){clearMarkers(),markers=[]}